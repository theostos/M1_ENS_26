<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../../.././style.css"></link><link rel="icon" href="../../../.././favicon.svg"></link><link rel="mask-icon" href="../../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../../.././/declarations/declaration-data.bmp" as="image"></link><title>Mathlib.Analysis.CStarAlgebra.ContinuousFunctionalCalculus.Note</title><script defer="true" src="../../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../../.././";</script><script>const MODULE_NAME="Mathlib.Analysis.CStarAlgebra.ContinuousFunctionalCalculus.Note";</script><script type="module" src="../../../.././jump-src.js"></script><script type="module" src="../../../.././search.js"></script><script type="module" src="../../../.././expand-nav.js"></script><script type="module" src="../../../.././how-about.js"></script><script type="module" src="../../../.././instances.js"></script><script type="module" src="../../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Mathlib</span>.<span class="name">Analysis</span>.<span class="name">CStarAlgebra</span>.<span class="name">ContinuousFunctionalCalculus</span>.<span class="name">Note</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/Note.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../../.././Init.html">Init</a></li><li><a href="../../../.././Mathlib/Init.html">Mathlib.Init</a></li><li><a href="../../../.././Mathlib/Tactic/Basic.html">Mathlib.Tactic.Basic</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Mathlib.Analysis.CStarAlgebra.ContinuousFunctionalCalculus.Note" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#LibraryNote.«continuous functional calculus»"><span class="name">LibraryNote</span>.<span class="name">«continuous functional calculus»</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="Documentation-concerning-the-continuous-functional-calculus">Documentation concerning the continuous functional calculus <a class="hover-link" href="#Documentation-concerning-the-continuous-functional-calculus">#</a></h1><p>A library note giving advice on developing and using the continuous functional calculus, as well
as the organizational structure within Mathlib.</p></div><div class="decl" id="LibraryNote.«continuous functional calculus»"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/Note.lean#L21-L180">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../../../.././Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/Note.html#LibraryNote.«continuous functional calculus»"><span class="name">LibraryNote</span>.<span class="name">«continuous functional calculus»</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../../../.././Batteries/Util/LibraryNote.html#Batteries.Util.LibraryNote">Batteries.Util.LibraryNote</a></div></div><h1 class="markdown-heading" id="The-continuous-functional-calculus">The continuous functional calculus <a class="hover-link" href="#The-continuous-functional-calculus">#</a></h1><p>In Mathlib, there are two classes --- <code>NonUnitalContinuousFunctionalCalculus</code> and
<code>ContinuousFunctionalCalculus</code>, indexed by the scalar ring <code>R</code> and the predicate <code>p : A → Prop</code>
which must be satisfied --- which are used to provide the interface to the continuous functional
calculus. This allows us to reason about the continuous functional calculus in both unital and
non-unital algebras, using functions, <code>ℂ → ℂ</code>, <code>ℝ → ℝ</code>, or <code>ℝ≥0 → ℝ≥0</code>, as appropriate.</p><p>These classes are designed to be used even in contexts where no norm is present, such as for
<code>Matrix n n ℝ</code>, and indeed, an instance of <code>ContinuousFunctionalCalculus ℝ A IsSelfAdjoint</code> already
exists in this context. However, when a norm is present (i.e., in the context of C⋆-algebras), the
continuous functional calculus is an isometry. In order not to lose this information, we provide
two additional classes <code>IsometricNonUnitalContinuousFunctionalCalculus</code> and
<code>IsometricContinuousFunctionalCalculus</code>, extending the classes above. We encode this as a class
for two reasons:</p><ol>
<li>to provide a uniform interface for multiple scalar rings</li>
<li>to allow for generalization to real C⋆-algebras</li>
</ol><p>This means that there are twelve different classes, corresponding to the choices of scalar ring
(<code>ℂ</code>, <code>ℝ</code>, or <code>ℝ≥0</code>), unital or non-unital algebras, isometric or not. The relationship between
these is documented in the diagram below, with arrows indicating always available instances.
The dotted arrow requires the presence of instances <code>PartialOrder A</code>, <code>StarOrderedRing A</code> and
<code>NonnegSpectrumClass ℝ A</code>. Note that the instances which change scalar rings occur <em>within</em> each
class (i.e., <code>ContinuousFunctionalCalculus</code>, <code>IsometricContinuousFunctionalCalculus</code>, etc.), so a
more accurate diagram would have the chain on the left embedded within each node of the graph
on the right.</p><pre><code>┌─────────┐     ┌──────────────────────┐
│         │     │                      │
│ Complex │     │   Isometric unital   ├──────────┐
│         │     │                      │          │
└────┬────┘     └───────────┬──────────┘          │
     │                      │                     │
     │                      │                     │
     ▼                      ▼                     ▼
┌─────────┐     ┌──────────────────────┐     ┌────────┐
│         │     │                      │     │        │
│   Real  │     │ Isometric non-unital │     │ Unital │
│         │     │                      │     │        │
└────┬────┘     └───────────┬──────────┘     └────┬───┘
     :                      │                     │
     :                      │                     │
     ▼                      ▼                     │
┌─────────┐     ┌──────────────────────┐          │
│         │     │                      │          │
│  NNReal │     │      Non-unital      │◄─────────┘
│         │     │                      │
└─────────┘     └──────────────────────┘
</code></pre><h2 class="markdown-heading" id="Developing-general-theory">Developing general theory <a class="hover-link" href="#Developing-general-theory">#</a></h2><p>When developing general theory of the continuous functional calculus, users should work in the
appropriate general class. For example, the positive and negative parts of a selfadjoint element
are defined using the continuous functional calculus via the functions <code>(·⁺ : ℝ → ℝ)</code> and
<code>(·⁻ : ℝ → ℝ)</code>. These functions both take the value <code>0</code> at <code>0</code>, and so work equally well in the
non-unital setting. Moreover, the only scalar ring needed is <code>ℝ</code>, not <code>ℂ</code>. Therefore, the correct
context in which to develop the basic theory of positive and negative parts is:</p><pre><code class="language-lean">variable {A : Type*} [NonUnitalRing A] [Module ℝ A] [SMulCommClass ℝ A A] [IsScalarTower ℝ A A]
  [StarRing A] [TopologicalSpace A] [NonUnitalContinuousFunctionalCalculus ℝ A IsSelfAdjoint]
</code></pre><p>One pattern that should <em>never</em> be used is to directly assume <code>ContinuousFunctionalCalculus</code>
(or the non-unital version) over the scalar ring <code>ℝ≥0</code>. Doing so only complicates the setup, for
no benefit. Indeed, in practice the only available instance of
<code>ContinuousFunctionalCalculus ℝ≥0 A (0 ≤ ·)</code> is the one stemming from an instance over <code>ℝ</code>, along
with <code>NonnegSpectrumClass ℝ A</code>, <code>PartialOrder A</code>, <code>StarOrderedRing A</code>. Therefore, directly assuming
the <code>ℝ≥0</code> version makes Lean do more work in type class inference, and makes the structure of the
source code less readable. Instead, the correct pattern is to assume the version over <code>ℝ</code>, and then
add these extra three classes as needed to get the instance over <code>ℝ≥0</code>.</p><p>There are three questions that an author should ask themselves when developing general theory
in order to determine the correct <code>variable</code>s to have in context. These are:</p><ol>
<li>Does this work for arbitrary scalar (semi)rings? Only <code>ℂ</code>, or is <code>ℝ</code> sufficient?</li>
</ol><p>For arbitrary scalar rings, use <code>R</code> with a predicate <code>p : A → Prop</code>, and assume that <code>A</code> is an
<code>R</code>-algebra. For <code>ℂ</code> use <code>IsStarNormal</code> and assume <code>A</code> is a <code>ℂ</code>-algebra. For <code>ℝ</code> use
<code>IsSelfAdjoint</code> and assume <code>A</code> is an <code>ℝ</code>-algebra. Reminder, if you need the functional calculus
over <code>ℝ≥0</code>, simply use the <code>ℝ</code> setup with the three extra classes.</p><ol start="2">
<li>Does this work in non-unital algebras?</li>
</ol><p>This determines whether you should use the unital or <code>NonUnital</code> variation, and whether your
algebra should be unital or non-unital.</p><ol start="3">
<li>Does this require norm properties of the algebra?</li>
</ol><p>This determines whether you should use the standard version or the <code>Isometric</code> variation.
If you are not using the <code>Isometric</code> variation, you should generally only assume that <code>A</code> is a
<code>TopologicalSpace</code> (or potentially a topological algebra). If you are using the <code>Isometric</code>
variation, you should assume that <code>A</code> is a <code>NormedAlgebra</code> (in the unital case) or a <code>NormedSpace</code>
(in the non-unital case).</p><p>Of course, sometimes one needs to have different sections which make different assumptions, even
for the same functions considered. For instance, although theory of positive and negative parts
should be developed in the maximum generality of non-unital <code>ℝ</code>-algebras without a norm, certain
results require stronger assumptions. A typical example is that there should be lemmas which
say <code>cfcₙ (·⁺ : ℝ → ℝ) (1 : A) = 1</code> and <code>cfcₙ (·⁻ : ℝ → ℝ) (1 : A) = 0</code>, but obviously these lemmas
require <code>A</code> to be a unital algebra. For these results (which work over <code>ℝ</code>, only in unital algebras,
and don't reference the norm), the correct context is (note the unital version of the functional
calculus despite the fact that the lemmas are about <code>cfcₙ</code>):</p><pre><code class="language-lean">variable {A : Type*} [Ring A] [Algebra ℝ A] [StarRing A] [TopologicalSpace A]
  [ContinuousFunctionalCalculus ℝ A IsSelfAdjoint]
</code></pre><p>The only context in which general theory should be developed with a <code>NonUnitalCStarAlgebra</code> or
<code>CStarAlgebra</code> hypothesis is when the norm structure is required and the only scalar ring which
works is <code>ℂ</code>.</p><h2 class="markdown-heading" id="Uniqueness">Uniqueness <a class="hover-link" href="#Uniqueness">#</a></h2><p>Unless you are developing theory over arbitrary scalar rings, it should never be necessary to
assume <code>ContinuousMap.UniqueHom</code> or <code>ContinuousMapZero.UniqueHom</code>, despite the fact that these
hypotheses are necessary for certain lemmas (in particular, <code>cfc_comp</code>). Over <code>ℝ</code> and <code>ℂ</code>, this
instance should always be available, and for <code>ℝ≥0</code>, one needs only to have the additional
assumptions <code>T2Space A</code> and <code>IsTopologicalRing A</code> (as before, the algebra <code>A</code> should still be an
<code>ℝ</code>-algebra).</p><h2 class="markdown-heading" id="Using-autoParam">Using <code><a href="../../../.././Init/Tactics.html#autoParam">autoParam</a></code> <a class="hover-link" href="#Using-autoParam">#</a></h2><p>Mathlib makes heavy use of <code><a href="../../../.././Init/Tactics.html#autoParam">autoParam</a></code>s in the continuous functional calculus. There are three
different tactics which are used:</p><ol>
<li><code>cfc_tac</code> for proving goals of the form <code>IsStarNormal a</code>, <code>IsSelfAdjoint a</code> or <code>0 ≤ a</code>.</li>
<li><code>cfc_cont_tac</code> for proving goals of the form <code>ContinuousOn (spectrum R a) f</code>.</li>
<li><code>cfc_zero_tac</code> for proving goals of the form <code>f 0 = 0</code>.</li>
</ol><p>In general, lemmas about the continuous functional calculus should be written using <code><a href="../../../.././Init/Tactics.html#autoParam">autoParam</a></code>s
wherever possible for these kinds of goals. These arguments should be placed <em>last</em>, at least among
the explicit arguments. Moreover, if the arguments <code>f</code> and <code>a</code> cannot be inferred from other
explicit arguments (i.e., those which are not <code><a href="../../../.././Init/Tactics.html#autoParam">autoParam</a></code>s), then they should also be <em>explicit</em>
rather than implicit, despite the fact that they appear in the types of the <code><a href="../../../.././Init/Tactics.html#autoParam">autoParam</a></code> arguments.
The reason is that it is often necessary to supply these arguments in order for the <code><a href="../../../.././Init/Tactics.html#autoParam">autoParam</a></code>
arguments to fire.</p><p>As to argument order, we generally prefer functions before elements of the algebra (i.e., <code>f</code> and
then <code>a</code>) to match the order of application (i.e., <code>cfc f a</code>). Likewise, we generally place the
<code><a href="../../../.././Init/Tactics.html#autoParam">autoParam</a></code>s for the continuity conditions before the others because these are the most likely to
require manual intervention.</p><h2 class="markdown-heading" id="Location-in-Mathlib">Location in Mathlib <a class="hover-link" href="#Location-in-Mathlib">#</a></h2><p>The criterion for determining where to place files about general theory of functions pertaining to
the continuous functional calculus is whether the import
<code><a href="../../../.././Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/Basic.html">Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/Basic.lean</a></code> is needed, which contains
the instances of the continuous functional calculus for <code>CStarAlgebra</code>, and therefore pulls in many
imports. If this import is not needed, then the file should be placed in the directory
<code><a href="../../../.././Mathlib/Analysis/SpecialFunctions/ContinuousFunctionalCalculus.html">Mathlib/Analysis/SpecialFunctions/ContinuousFunctionalCalculus.lean</a></code>. If this import is needed
then the appropriate location is <code><a href="../../../.././Mathlib/Analysis/CStarAlgebra/SpecialFunctions.html">Mathlib/Analysis/CStarAlgebra/SpecialFunctions.lean</a></code>.
If, as is often thecase, some results need the import and others do not, there should be two files,
one in each location.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href="../../../.././Mathlib/Analysis/CStarAlgebra/ContinuousFunctionalCalculus/Note.html#LibraryNote.«continuous functional calculus»">LibraryNote.«continuous functional calculus»</a> <a href="../../../.././Init/Prelude.html#Eq">=</a> <a href="../../../.././Init/Prelude.html#Inhabited.default">default</a></li></ul></details><details id="instances-for-list-LibraryNote.«continuous functional calculus»" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>