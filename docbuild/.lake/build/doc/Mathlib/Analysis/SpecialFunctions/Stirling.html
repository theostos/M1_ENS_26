<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../../.././style.css"></link><link rel="icon" href="../../.././favicon.svg"></link><link rel="mask-icon" href="../../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../../.././/declarations/declaration-data.bmp" as="image"></link><title>Mathlib.Analysis.SpecialFunctions.Stirling</title><script defer="true" src="../../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../../.././";</script><script>const MODULE_NAME="Mathlib.Analysis.SpecialFunctions.Stirling";</script><script type="module" src="../../.././jump-src.js"></script><script type="module" src="../../.././search.js"></script><script type="module" src="../../.././expand-nav.js"></script><script type="module" src="../../.././how-about.js"></script><script type="module" src="../../.././instances.js"></script><script type="module" src="../../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Mathlib</span>.<span class="name">Analysis</span>.<span class="name">SpecialFunctions</span>.<span class="name">Stirling</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../../.././Init.html">Init</a></li><li><a href="../../.././Mathlib/Analysis/PSeries.html">Mathlib.Analysis.PSeries</a></li><li><a href="../../.././Mathlib/Tactic/AdaptationNote.html">Mathlib.Tactic.AdaptationNote</a></li><li><a href="../../.././Mathlib/Analysis/Real/Pi/Wallis.html">Mathlib.Analysis.Real.Pi.Wallis</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Mathlib.Analysis.SpecialFunctions.Stirling" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Stirling.stirlingSeq"><span class="name">Stirling</span>.<span class="name">stirlingSeq</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.stirlingSeq_zero"><span class="name">Stirling</span>.<span class="name">stirlingSeq_zero</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.stirlingSeq_one"><span class="name">Stirling</span>.<span class="name">stirlingSeq_one</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.log_stirlingSeq_formula"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_formula</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.log_stirlingSeq_diff_hasSum"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_diff_hasSum</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.log_stirlingSeq'_antitone"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq'_antitone</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.log_stirlingSeq_diff_le_geo_sum"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_diff_le_geo_sum</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.log_stirlingSeq_sub_log_stirlingSeq_succ"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_sub_log_stirlingSeq_succ</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.log_stirlingSeq_bounded_aux"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_bounded_aux</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.log_stirlingSeq_bounded_by_constant"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_bounded_by_constant</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.stirlingSeq'_pos"><span class="name">Stirling</span>.<span class="name">stirlingSeq'_pos</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.stirlingSeq'_bounded_by_pos_constant"><span class="name">Stirling</span>.<span class="name">stirlingSeq'_bounded_by_pos_constant</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.stirlingSeq'_antitone"><span class="name">Stirling</span>.<span class="name">stirlingSeq'_antitone</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.stirlingSeq_has_pos_limit_a"><span class="name">Stirling</span>.<span class="name">stirlingSeq_has_pos_limit_a</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.tendsto_self_div_two_mul_self_add_one"><span class="name">Stirling</span>.<span class="name">tendsto_self_div_two_mul_self_add_one</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.stirlingSeq_pow_four_div_stirlingSeq_pow_two_eq"><span class="name">Stirling</span>.<span class="name">stirlingSeq_pow_four_div_stirlingSeq_pow_two_eq</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.second_wallis_limit"><span class="name">Stirling</span>.<span class="name">second_wallis_limit</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.tendsto_stirlingSeq_sqrt_pi"><span class="name">Stirling</span>.<span class="name">tendsto_stirlingSeq_sqrt_pi</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.factorial_isEquivalent_stirling"><span class="name">Stirling</span>.<span class="name">factorial_isEquivalent_stirling</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.sqrt_pi_le_stirlingSeq"><span class="name">Stirling</span>.<span class="name">sqrt_pi_le_stirlingSeq</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.le_factorial_stirling"><span class="name">Stirling</span>.<span class="name">le_factorial_stirling</span></a></div><div class="nav_link"><a class="break_within" href="#Stirling.le_log_factorial_stirling"><span class="name">Stirling</span>.<span class="name">le_log_factorial_stirling</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="Stirling-s-formula">Stirling's formula <a class="hover-link" href="#Stirling-s-formula">#</a></h1><p>This file proves Stirling's formula for the factorial.
It states that $n!$ grows asymptotically like $\sqrt{2\pi n}(\frac{n}{e})^n$.</p><p>Also some <em>global</em> bounds on the factorial function and the Stirling sequence are proved.</p><h2 class="markdown-heading" id="Proof-outline">Proof outline <a class="hover-link" href="#Proof-outline">#</a></h2><p>The proof follows: <a href="https://proofwiki.org/wiki/Stirling%27s_Formula">https://proofwiki.org/wiki/Stirling%27s_Formula</a>.</p><p>We proceed in two parts.</p><p><strong>Part 1</strong>: We consider the sequence $a_n$ of fractions $\frac{n!}{\sqrt{2n}(\frac{n}{e})^n}$
and prove that this sequence converges to a real, positive number $a$. For this the two main
ingredients are</p><ul>
<li>taking the logarithm of the sequence and</li>
<li>using the series expansion of $\log(1 + x)$.</li>
</ul><p><strong>Part 2</strong>: We use the fact that the series defined in part 1 converges against a real number $a$
and prove that $a = \sqrt{\pi}$. Here the main ingredient is the convergence of Wallis' product
formula for <code>π</code>.</p></div><div class="mod_doc"><h3 class="markdown-heading" id="Part-1">Part 1 <a class="hover-link" href="#Part-1">#</a></h3><p>https://proofwiki.org/wiki/Stirling%27s_Formula#Part_1</p></div><div class="decl" id="Stirling.stirlingSeq"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L53-L57">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq"><span class="name">Stirling</span>.<span class="name">stirlingSeq</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a></div></div><p>Define <code><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> n</code> as $\frac{n!}{\sqrt{2n}(\frac{n}{e})^n}$.
Stirling's formula states that this sequence has limit $\sqrt(π)$.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">Stirling.stirlingSeq</a> <span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">↑<span class="fn"><span class="fn">n</span>.<a href="../../.././Mathlib/Data/Nat/Factorial/Basic.html#Nat.factorial">factorial</a></span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<a href="../../.././Mathlib/Data/Real/Sqrt.html#Real.sqrt">√</a>(<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑<span class="fn">n</span></span>) <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> (<span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href="../../.././Mathlib/Analysis/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">1</span></span>) <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span>)</li></ul></details><details id="instances-for-list-Stirling.stirlingSeq" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Stirling.stirlingSeq_zero"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L59-L61">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq_zero"><span class="name">Stirling</span>.<span class="name">stirlingSeq_zero</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <span class="fn">0</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn">0</span></div></div></div></div><div class="decl" id="Stirling.stirlingSeq_one"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L63-L65">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq_one"><span class="name">Stirling</span>.<span class="name">stirlingSeq_one</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <span class="fn">1</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../../.././Mathlib/Analysis/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">1</span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <a href="../../.././Mathlib/Data/Real/Sqrt.html#Real.sqrt">√</a><span class="fn">2</span></div></div></div></div><div class="decl" id="Stirling.log_stirlingSeq_formula"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L67-L72">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.log_stirlingSeq_formula"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_formula</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <span class="fn">n</span>)</span></span> <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">↑<span class="fn"><span class="fn">n</span>.<a href="../../.././Mathlib/Data/Nat/Factorial/Basic.html#Nat.factorial">factorial</a></span></span></span> <a href="../../.././Init/Prelude.html#HSub.hSub">-</a> <span class="fn"><span class="fn">1</span> / <span class="fn">2</span></span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑<span class="fn">n</span></span>)</span> <a href="../../.././Init/Prelude.html#HSub.hSub">-</a> <span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> (<span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href="../../.././Mathlib/Analysis/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">1</span></span>)</span></div></div></div></div><div class="decl" id="Stirling.log_stirlingSeq_diff_hasSum"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L74-L91">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.log_stirlingSeq_diff_hasSum"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_diff_hasSum</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">m</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Topology/Algebra/InfiniteSum/Defs.html#HasSum">HasSum</a> <span class="fn">(fun (<span class="fn">k</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>) =&gt; <span class="fn">1</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑(<span class="fn">k</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>) <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> ((<span class="fn">1</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑(<span class="fn">m</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)) <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">2</span>) <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> (<span class="fn">k</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span>
  (<span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">m</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span></span> <a href="../../.././Init/Prelude.html#HSub.hSub">-</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">m</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">2</span>))</span></span>)</span></div></div><p>The sequence <code>log (stirlingSeq (m + 1)) - log (stirlingSeq (m + 2))</code> has the series expansion
<code>∑ 1 / (2 * (k + 1) + 1) * (1 / 2 * (m + 1) + 1)^(2 * (k + 1))</code>.</p></div></div><div class="decl" id="Stirling.log_stirlingSeq'_antitone"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L93-L96">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.log_stirlingSeq'_antitone"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq'_antitone</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Order/Monotone/Defs.html#Antitone">Antitone</a> (<a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <a href="../../.././Init/Prelude.html#Function.comp">∘</a> <a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <a href="../../.././Init/Prelude.html#Function.comp">∘</a> <a href="../../.././Init/Prelude.html#Nat.succ">Nat.succ</a>)</span></div></div><p>The sequence <code>log ∘ <a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> ∘ succ</code> is monotone decreasing</p></div></div><div class="decl" id="Stirling.log_stirlingSeq_diff_le_geo_sum"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L98-L116">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.log_stirlingSeq_diff_le_geo_sum"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_diff_le_geo_sum</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span></span> <a href="../../.././Init/Prelude.html#HSub.hSub">-</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">2</span>))</span></span> <a href="../../.././Init/Prelude.html#LE.le">≤</a>   (<span class="fn">1</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑(<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)) <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">2</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">1</span> <a href="../../.././Init/Prelude.html#HSub.hSub">-</a> (<span class="fn">1</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑(<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)) <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">2</span>)</div></div><p>We have a bound for successive elements in the sequence <code>log (stirlingSeq k)</code>.</p></div></div><div class="decl" id="Stirling.log_stirlingSeq_sub_log_stirlingSeq_succ"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L118-L131">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.log_stirlingSeq_sub_log_stirlingSeq_succ"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_sub_log_stirlingSeq_succ</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span></span> <a href="../../.././Init/Prelude.html#HSub.hSub">-</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">2</span>))</span></span> <a href="../../.././Init/Prelude.html#LE.le">≤</a> <span class="fn">1</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">4</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑(<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span> <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">2</span>)</div></div><p>We have the bound <code>log (stirlingSeq n) - log (stirlingSeq (n+1))</code> ≤ 1/(4 n^2)</p></div></div><div class="decl" id="Stirling.log_stirlingSeq_bounded_aux"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L133-L152">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.log_stirlingSeq_bounded_aux"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_bounded_aux</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">∃ (<span class="fn">c</span> : <a href="../../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a>), <span class="fn">∀ (<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>), <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <span class="fn">1</span>)</span></span> <a href="../../.././Init/Prelude.html#HSub.hSub">-</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span></span> <a href="../../.././Init/Prelude.html#LE.le">≤</a> <span class="fn">c</span></span></span></div></div><p>For any <code>n</code>, we have <code>log_stirlingSeq 1 - log_stirlingSeq n ≤ 1/4 * ∑' 1/k^2</code></p></div></div><div class="decl" id="Stirling.log_stirlingSeq_bounded_by_constant"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L154-L157">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.log_stirlingSeq_bounded_by_constant"><span class="name">Stirling</span>.<span class="name">log_stirlingSeq_bounded_by_constant</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">∃ (<span class="fn">c</span> : <a href="../../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a>), <span class="fn">∀ (<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>), <span class="fn">c</span> <a href="../../.././Init/Prelude.html#LE.le">≤</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">(<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span></span></span></span></div></div><p>The sequence <code>log_stirlingSeq</code> is bounded below for <code>n ≥ 1</code>.</p></div></div><div class="decl" id="Stirling.stirlingSeq'_pos"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L159-L160">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq'_pos"><span class="name">Stirling</span>.<span class="name">stirlingSeq'_pos</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">0</span> <a href="../../.././Init/Prelude.html#LT.lt">&lt;</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span></div></div><p>The sequence <code><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a></code> is positive for <code>n &gt; 0</code></p></div></div><div class="decl" id="Stirling.stirlingSeq'_bounded_by_pos_constant"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L162-L168">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq'_bounded_by_pos_constant"><span class="name">Stirling</span>.<span class="name">stirlingSeq'_bounded_by_pos_constant</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">∃ (<span class="fn">a</span> : <a href="../../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a>), <span class="fn">0</span> <a href="../../.././Init/Prelude.html#LT.lt">&lt;</a> <span class="fn">a</span> <a href="../../.././Init/Prelude.html#And">∧</a> <span class="fn">∀ (<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>), <span class="fn">a</span> <a href="../../.././Init/Prelude.html#LE.le">≤</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">n</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)</span></span></span></div></div><p>The sequence <code><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a></code> has a positive lower bound.</p></div></div><div class="decl" id="Stirling.stirlingSeq'_antitone"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L170-L172">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq'_antitone"><span class="name">Stirling</span>.<span class="name">stirlingSeq'_antitone</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Order/Monotone/Defs.html#Antitone">Antitone</a> (<a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <a href="../../.././Init/Prelude.html#Function.comp">∘</a> <a href="../../.././Init/Prelude.html#Nat.succ">Nat.succ</a>)</span></div></div><p>The sequence <code><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> ∘ succ</code> is monotone decreasing</p></div></div><div class="decl" id="Stirling.stirlingSeq_has_pos_limit_a"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L174-L180">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq_has_pos_limit_a"><span class="name">Stirling</span>.<span class="name">stirlingSeq_has_pos_limit_a</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">∃ (<span class="fn">a</span> : <a href="../../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a>), <span class="fn">0</span> <a href="../../.././Init/Prelude.html#LT.lt">&lt;</a> <span class="fn">a</span> <a href="../../.././Init/Prelude.html#And">∧</a> <span class="fn"><a href="../../.././Mathlib/Order/Filter/Defs.html#Filter.Tendsto">Filter.Tendsto</a> <a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <a href="../../.././Mathlib/Order/Filter/AtTopBot/Defs.html#Filter.atTop">Filter.atTop</a> <span class="fn">(<a href="../../.././Mathlib/Topology/Defs/Filter.html#nhds">nhds</a> <span class="fn">a</span>)</span></span></span></div></div><p>The limit <code>a</code> of the sequence <code><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a></code> satisfies <code>0 &lt; a</code></p></div></div><div class="mod_doc"><h3 class="markdown-heading" id="Part-2">Part 2 <a class="hover-link" href="#Part-2">#</a></h3><p>https://proofwiki.org/wiki/Stirling%27s_Formula#Part_2</p></div><div class="decl" id="Stirling.tendsto_self_div_two_mul_self_add_one"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L188-L198">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.tendsto_self_div_two_mul_self_add_one"><span class="name">Stirling</span>.<span class="name">tendsto_self_div_two_mul_self_add_one</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Order/Filter/Defs.html#Filter.Tendsto">Filter.Tendsto</a> <span class="fn">(fun (<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>) =&gt; <span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>))</span> <a href="../../.././Mathlib/Order/Filter/AtTopBot/Defs.html#Filter.atTop">Filter.atTop</a> <span class="fn">(<a href="../../.././Mathlib/Topology/Defs/Filter.html#nhds">nhds</a> <span class="fn">(<span class="fn">1</span> / <span class="fn">2</span>)</span>)</span></span></div></div><p>The sequence <code>n / (2 * n + 1)</code> tends to <code>1/2</code></p></div></div><div class="decl" id="Stirling.stirlingSeq_pow_four_div_stirlingSeq_pow_two_eq"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L200-L211">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq_pow_four_div_stirlingSeq_pow_two_eq"><span class="name">Stirling</span>.<span class="name">stirlingSeq_pow_four_div_stirlingSeq_pow_two_eq</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hn</span> : <span class="fn">n</span> <a href="../../.././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">4</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">n</span>)</span> <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> (<span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn">1</span>)) <a href="../../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../../.././Mathlib/Analysis/Real/Pi/Wallis.html#Real.Wallis.W">Real.Wallis.W</a> <span class="fn">n</span></span></div></div><p>For any <code>n ≠ 0</code>, we have the identity
<code>(stirlingSeq n)^4 / (stirlingSeq (2*n))^2 * (n / (2 * n + 1)) = W n</code>, where <code>W n</code> is the
<code>n</code>-th partial product of Wallis' formula for <code>π / 2</code>.</p></div></div><div class="decl" id="Stirling.second_wallis_limit"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L213-L225">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.second_wallis_limit"><span class="name">Stirling</span>.<span class="name">second_wallis_limit</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">a</span> : <a href="../../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hane</span> : <span class="fn">a</span> <a href="../../.././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">ha</span> : <span class="fn"><a href="../../.././Mathlib/Order/Filter/Defs.html#Filter.Tendsto">Filter.Tendsto</a> <a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <a href="../../.././Mathlib/Order/Filter/AtTopBot/Defs.html#Filter.atTop">Filter.atTop</a> <span class="fn">(<a href="../../.././Mathlib/Topology/Defs/Filter.html#nhds">nhds</a> <span class="fn">a</span>)</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Order/Filter/Defs.html#Filter.Tendsto">Filter.Tendsto</a> <a href="../../.././Mathlib/Analysis/Real/Pi/Wallis.html#Real.Wallis.W">Real.Wallis.W</a> <a href="../../.././Mathlib/Order/Filter/AtTopBot/Defs.html#Filter.atTop">Filter.atTop</a> <span class="fn">(<a href="../../.././Mathlib/Topology/Defs/Filter.html#nhds">nhds</a> (<span class="fn">a</span> <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">2</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">2</span>))</span></span></div></div><p>Suppose the sequence <code><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a></code> (defined above) has the limit <code>a ≠ 0</code>.
Then the Wallis sequence <code>W n</code> has limit <code>a^2 / 2</code>.</p></div></div><div class="decl" id="Stirling.tendsto_stirlingSeq_sqrt_pi"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L227-L232">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.tendsto_stirlingSeq_sqrt_pi"><span class="name">Stirling</span>.<span class="name">tendsto_stirlingSeq_sqrt_pi</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Order/Filter/Defs.html#Filter.Tendsto">Filter.Tendsto</a> <a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <a href="../../.././Mathlib/Order/Filter/AtTopBot/Defs.html#Filter.atTop">Filter.atTop</a> <span class="fn">(<a href="../../.././Mathlib/Topology/Defs/Filter.html#nhds">nhds</a> <a href="../../.././Mathlib/Data/Real/Sqrt.html#Real.sqrt">√</a><a href="../../.././Mathlib/Analysis/SpecialFunctions/Trigonometric/Basic.html#Real.pi">Real.pi</a>)</span></span></div></div><p><strong>Stirling's Formula</strong></p></div></div><div class="decl" id="Stirling.factorial_isEquivalent_stirling"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L234-L244">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.factorial_isEquivalent_stirling"><span class="name">Stirling</span>.<span class="name">factorial_isEquivalent_stirling</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../../.././Mathlib/Analysis/Asymptotics/AsymptoticEquivalent.html#Asymptotics.IsEquivalent">Asymptotics.IsEquivalent</a> <a href="../../.././Mathlib/Order/Filter/AtTopBot/Defs.html#Filter.atTop">Filter.atTop</a> <span class="fn">(fun (<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>) =&gt; <span class="fn">↑<span class="fn"><span class="fn">n</span>.<a href="../../.././Mathlib/Data/Nat/Factorial/Basic.html#Nat.factorial">factorial</a></span></span>)</span> <span class="fn">fun (<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>) =&gt;
  <a href="../../.././Mathlib/Data/Real/Sqrt.html#Real.sqrt">√</a>(<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <a href="../../.././Mathlib/Analysis/SpecialFunctions/Trigonometric/Basic.html#Real.pi">Real.pi</a>) <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> (<span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href="../../.././Mathlib/Analysis/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">1</span></span>) <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span></span></span></div></div><p><strong>Stirling's Formula</strong>, formulated in terms of <code><a href="../../.././Mathlib/Analysis/Asymptotics/AsymptoticEquivalent.html#Asymptotics.IsEquivalent">Asymptotics.IsEquivalent</a></code>.</p></div></div><div class="mod_doc"><h3 class="markdown-heading" id="Global-bounds">Global bounds <a class="hover-link" href="#Global-bounds">#</a></h3></div><div class="decl" id="Stirling.sqrt_pi_le_stirlingSeq"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L248-L256">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.sqrt_pi_le_stirlingSeq"><span class="name">Stirling</span>.<span class="name">sqrt_pi_le_stirlingSeq</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">hn</span> : <span class="fn">n</span> <a href="../../.././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Mathlib/Data/Real/Sqrt.html#Real.sqrt">√</a><a href="../../.././Mathlib/Analysis/SpecialFunctions/Trigonometric/Basic.html#Real.pi">Real.pi</a> <a href="../../.././Init/Prelude.html#LE.le">≤</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.stirlingSeq">stirlingSeq</a> <span class="fn">n</span></span></div></div><p>The Stirling sequence is bounded below by <code>√π</code>, for all positive naturals. Note that this bound
holds for all <code>n &gt; 0</code>, rather than for sufficiently large <code>n</code>: it is effective.</p></div></div><div class="decl" id="Stirling.le_factorial_stirling"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L258-L272">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.le_factorial_stirling"><span class="name">Stirling</span>.<span class="name">le_factorial_stirling</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../../.././Mathlib/Data/Real/Sqrt.html#Real.sqrt">√</a>(<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <a href="../../.././Mathlib/Analysis/SpecialFunctions/Trigonometric/Basic.html#Real.pi">Real.pi</a> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑<span class="fn">n</span></span>) <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> (<span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href="../../.././Mathlib/Analysis/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">1</span></span>) <a href="../../.././Init/Prelude.html#HPow.hPow">^</a> <span class="fn">n</span> <a href="../../.././Init/Prelude.html#LE.le">≤</a> <span class="fn">↑<span class="fn"><span class="fn">n</span>.<a href="../../.././Mathlib/Data/Nat/Factorial/Basic.html#Nat.factorial">factorial</a></span></span></div></div><p>Stirling's approximation gives a lower bound for <code>n!</code> for all <code>n</code>.
The left-hand side is formulated to mimic the usual informal description of the approximation.
See also <code><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.factorial_isEquivalent_stirling">factorial_isEquivalent_stirling</a></code> which says these are asymptotically equivalent. That
statement gives an upper bound also, but requires sufficiently large <code>n</code>. In contrast, this one is
only a lower bound, but holds for all <code>n</code>.
Sharper bounds due to Robbins are available, but are not yet formalised.</p></div></div><div class="decl" id="Stirling.le_log_factorial_stirling"><div class="theorem"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/32d24245c7a12ded17325299fd41d412022cd3fe/Mathlib/Analysis/SpecialFunctions/Stirling.lean#L274-L290">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.le_log_factorial_stirling"><span class="name">Stirling</span>.<span class="name">le_log_factorial_stirling</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href="../../.././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">hn</span> : <span class="fn">n</span> <a href="../../.././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">↑<span class="fn">n</span></span></span> <a href="../../.././Init/Prelude.html#HSub.hSub">-</a> <span class="fn">↑<span class="fn">n</span></span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">↑<span class="fn">n</span></span></span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">2</span> <a href="../../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> (<span class="fn">2</span> <a href="../../.././Init/Prelude.html#HMul.hMul">*</a> <a href="../../.././Mathlib/Analysis/SpecialFunctions/Trigonometric/Basic.html#Real.pi">Real.pi</a>)</span> <a href="../../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">2</span> <a href="../../.././Init/Prelude.html#LE.le">≤</a> <span class="fn"><a href="../../.././Mathlib/Analysis/SpecialFunctions/Log/Basic.html#Real.log">Real.log</a> <span class="fn">↑<span class="fn"><span class="fn">n</span>.<a href="../../.././Mathlib/Data/Nat/Factorial/Basic.html#Nat.factorial">factorial</a></span></span></span></div></div><p>Stirling's approximation gives a lower bound for <code>log n!</code> for all positive <code>n</code>.
The left-hand side is formulated in decreasing order in <code>n</code>: the higher order terms are first.
This is a consequence of <code><a href="../../.././Mathlib/Analysis/SpecialFunctions/Stirling.html#Stirling.le_factorial_stirling">le_factorial_stirling</a></code>, but is stated separately since the logarithmic
version is sometimes more practical, and having this version eases algebraic calculations for
applications.
Sharper bounds due to Robbins are available, but are not yet formalised. These would add
lower order terms (beginning with <code>(12 * n)⁻¹</code>) to the left-hand side.</p></div></div></main>
<nav class="nav"><iframe src="../../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>